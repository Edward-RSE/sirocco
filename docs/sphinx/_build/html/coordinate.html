<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coordinate grids &mdash; python 88a documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Importing Models" href="wind_models/importing_models.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            python
          </a>
              <div class="version">
                88
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick.html"><em>Quick Guide to Python</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_python.html">Running Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Outputs &amp; Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">Plotting &amp; Processing Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="operation.html">Code Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="radiation.html">Radiation Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="wind_models.html">Wind Models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Coordinate grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="physics.html">Physics &amp; Radiative Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="atomic.html">Atomic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="meta.html">Meta-documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="py_progs.html">Python Scripts</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Coordinate grids</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/coordinate.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="coordinate-grids">
<h1>Coordinate grids<a class="headerlink" href="#coordinate-grids" title="Permalink to this heading"></a></h1>
<p>Python supports 3 main coordinate gridding schemes, as well as one that is
tailored to handle vertically extended disks. These schemes are</p>
<ul class="simple">
<li><p>1-d spherical</p></li>
<li><p>2-d cylindrical</p></li>
<li><p>2-d polar or r-theta coordinates</p></li>
</ul>
<p>These options are controlled by the <a class="reference internal" href="input/parameters/wind/Wind/Wind.coord_system.html"><span class="doc">Wind.coord_system</span></a> keyword. For vertically extended disks, a modified version of the a cylindrical schme is provided where the cells viewed along the x,z plane are parallelograms, so that the grid follows the disk surface.</p>
<p>Although Python incorporates several models, such as the SV model for disk winds, that are continuous, the velocities and other proporites are placed on a grid, as part of the setup that goes on at the beginining of program execution.</p>
<p>It is up to the user to choose an appropriate coordinate system and the number of grid points
to include in any particular run of the program.</p>
<p>As implemented within Python, the cells are created with a logarithmic spacing, that is the cells are larger the further they are from the central source (or disk plane).  The one exception to this is that for polar coordinates, the angular separation of cells is fixed.  For imported models, on
the other hand, the user sets the exact coordinate gridding.</p>
<p>Obviously, the larger the coordinate grid, 100 x 100, say, compared to 30 x 30, the better the
grid reflects a model.  Equally obviously, the larger the coordiante grid, the larger the amount of memory the program will consume, and the larger the amount of computer time the program will take to run to completion.  The increased computing is largely associated with the fact that one needs a good representation of the spectral energy distribution in each cell in order to properly calculate the ionization state in each cell.</p>
<p>Although the amount of memory for particular model generaly scales with the size of the grid, different 100 x 100 models, can consume
very different amounts of memory.  This is because for the KWD and SV parameterizations, the wind does not fill all of space.
What really matters is the numbers of cells that are in the wind, because these are the cells for which all of the information about plasma conditions and the radition field needs to be maintained.
So a wide angle wind with a 100 x 100 grid can take much more memory than a narrow angle wind on the same grid.</p>
<p>It is the number of cells that are actually in the wind that determine the fidelity of the model.</p>
<section id="partial-cells">
<h2>Partial cells<a class="headerlink" href="#partial-cells" title="Permalink to this heading"></a></h2>
<p>As note above, parameterized models often have region of space that are in the wind and regions whch are not.  If one overlays, a coordinate grid
on such a model, there will be cells that cross edges of the wind.  These partial cells present particular problems.</p>
<p>In Python, velocities are interpolated on the corners of wind cells, but densities are are calculated based on
the average radiation field in a cell, and hence
ion densities are actually cell centered. As photons pass through a cell, they encounter resonances and the actuall opacities are
based on an interpolated value of the densities. This presents no particular problem in regions inside the wind, but it is an issue for partial cells.</p>
<p>Currently, by default these cells are excluded by the calculation, and the densities of these cells are set to zero.
Because of densities are interpolated this affects the first cell that is completely in the wind.</p>
<p>There are two other alternatives:</p>
<ul class="simple">
<li><p>The partial cells can be included in the calculation.  This is reasonable for the KWD model, which has a velocity law that is easy to extend out side the wind region, but is less valid for the SV model, where this is not the case.  For the KWD model, the only issue with including partial cells is that they are “smaller” than cells which are fully in the wind, and as a result are less likely to converge as adjacent cells that are fully in the wind.</p></li>
<li><p>As an advanced option, the partial cells can be excluded, but instead of setting the density of the partial cell to zero, one can assign it the density of the “nearest” cell that is totally in the wind.  In this case the ionization balance of that cell is calculated using the information in the full cell, and the ion densities that are calculated in the edge of that cell during photon transfer are just those of the center of the cell, rather than an intepolation that has on ef the endpoints at zero.</p></li>
</ul>
<p>Most of the time, the treatment of partial cells does not change the predicted spectrum significantly, but this is something that is worthwhiled chacking. Users should be wary in situations where there are directions in which significant numbers of photons will pass though very few cells in the wind.  This could happen for a “narrow” wind with a very small opening angle.  Having a small number of cells in the wind is, of course, one should be concerned about in any event.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="wind_models/importing_models.html" class="btn btn-neutral float-left" title="Importing Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2024, Knox Long, Christian Knigge, Stuart Sim, Nick Higginbottom, James Matthews, Sam Mangham, Edward Parkinson, Mandy Hewitt, Nicolas Scepi, Austen Wallis, Amin Mosallanezhad.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>