<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Demo: Tidal Disruption Event &mdash; python 88a documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Benchmark: 1D Stellar Wind, CMFGEN" href="../../benchmarking/cmfgen.html" />
    <link rel="prev" title="Demo: Quasar, M20" href="../quasar/quasar.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            python
          </a>
              <div class="version">
                88
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../quick.html"><em>Quick Guide to Python</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../running_python.html">Running Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../input.html">Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../output.html">Outputs &amp; Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../plotting.html">Plotting &amp; Processing Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../operation.html">Code Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../radiation.html">Radiation Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../wind_models.html">Wind Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../coordinate.html">Coordinate grids</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../reverb/reverb.html">Reverberation Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quasar/quasar.html">Demo: Quasar, M20</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Demo: Tidal Disruption Event</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../benchmarking/cmfgen.html">Benchmark: 1D Stellar Wind, CMFGEN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../benchmarking/tardis.html">Benchmark: 1D Homologous SN, Tardis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../physics.html">Physics &amp; Radiative Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../atomic.html">Atomic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../meta.html">Meta-documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../py_progs.html">Python Scripts</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Demo: Tidal Disruption Event</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/examples/demo-models/tde/tde.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="demo-tidal-disruption-event">
<h1>Demo: Tidal Disruption Event<a class="headerlink" href="#demo-tidal-disruption-event" title="Permalink to this heading"></a></h1>
<p>One of the recent applications of Python is modelling outflows in Tidal
Disruption Events (TDEs). We have explored how line formation in an accretion
disc wind could explain the BAL vs. BEL dichotomy observed in the UV spectra of
TDEs. We have also explored how reprocessing in an accretion disc wring could
give rise to the, at one point, unexpected optically bright TDEs.</p>
<p>We now describe a model used to simulate both the UV and optical features of
TDEs.</p>
<section id="model-setup">
<h2>Model Setup<a class="headerlink" href="#model-setup" title="Permalink to this heading"></a></h2>
<section id="key-model-parameters">
<h3>Key Model Parameters<a class="headerlink" href="#key-model-parameters" title="Permalink to this heading"></a></h3>
<p>We model a disc wind outflow using the kinematic
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1993ApJ...409..372S/abstract">Shlosman &amp; Vitello (1993)</a>
(SV93) biconical disc wind model. This model has seen extensive use throughout the
history of Python to model across all length scales of accretion, from CVs to
QSO winds. Further information about the SV93 model can be found in the
documentation <a class="reference external" href="../../sv.rst">here</a>.</p>
<p>The key parameters controlling the geometry and central object in this model
are as follows.</p>
<p>Schwarzschild black hole parameters:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{R}_{\text{disc, in}}   &amp;=~10^{13} ~ \text{cm} \\
                             &amp;=~22.8 ~ \text{R}_{\text{g}} \\
\text{R}_{\text{disc, out}}  &amp;=~10^{15} ~ \text{cm} \\
                             &amp;=~2258 ~ \text{R}_{\text{g}} \\
\text{M}_{\text{BH}}         &amp;=~3 \times 10 \text{M}_{\odot} \\
\dot{\text{M}}_{\text{disc}} &amp;=~9.99 \times 10^{-3}~\text{M}_{\odot}~\text{yr}^{-1} \\
                             &amp;=~0.15~\dot{\text{M}}_{\text{Edd}}\end{split}\]</div>
<p>Wind geometry parameters:</p>
<div class="math notranslate nohighlight">
\[\begin{split}r_{\text{min}}        &amp;=~10^{13} ~ \text{cm} \\
                      &amp;=~22.8 ~ \text{R}_{\text{g}} \\
r_{\text{max}}        &amp;=~10^{15}~ \text{cm} \\
                      &amp;=~2258 ~ \text{R}_{\text{g}} \\
\alpha                &amp;=~1.5 \\
R_{v}                 &amp;=~5 \times 10^{16} ~ \\
                      &amp;=~1.13 \times 10^{5}~\text{R}_{\text{g}} \\
\theta_{\text{min}}   &amp;=~20^{\circ} \\
\theta_{\text{max}}   &amp;=~65^{\circ} \\
\text{R}_{\text{max}} &amp;=~5 \times 10^{17}~\text{cm} \\
                      &amp;=~1.13 \times 10^{6}~\text{R}_{\text{g}} \\
\gamma                &amp;=~1 \\
\lambda               &amp;=~0 \\
f_{v}                 &amp;=~0.1 \\\end{split}\]</div>
<p>For parameters controlling the radiative transfer and flow of Python, the
parameter file for this model can be found <a class="reference download internal" download="" href="../../../_downloads/be652952d1ffdce2b8f943ddc117377f/tde_fiducial.pf"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>.</p>
</section>
<section id="radiation-sources">
<h3>Radiation Sources<a class="headerlink" href="#radiation-sources" title="Permalink to this heading"></a></h3>
<p>There are two radiation sources in this model; the accretion disc and the wind
itself. Although, the wind does not act as a <em>net</em> source of photons, but rather
as a reprocessing medium. We assume that the wind is in radiative equilibrium
meaning any energy absorbed is reprocessed and re-radiated, i.e. via radiative
recombination. We treat the accretion disc as an ensemble of black bodies, using
a standard <span class="math notranslate nohighlight">\(\alpha\)</span>-disc effective temperature profile
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1973A%26A....24..337S/abstract">(Shakura &amp; Sunyaev, 1973)</a>.
The emergent SED is hence specified entirely by the mass accretion rate of
the accretion disc and the mass of the black hole.</p>
<p>The figure below shows the angle integrated SED for this model.</p>
<figure class="align-center" id="id1">
<img alt="../../../_images/tde_sed.png" src="../../../_images/tde_sed.png" />
<figcaption>
<p><span class="caption-text">The angle integrated accretion disc SED for the TDE model.</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="runtime">
<h2>Runtime<a class="headerlink" href="#runtime" title="Permalink to this heading"></a></h2>
<p>As the TDE outflow is optically thick, the model requires a fair amount of
computing power to be completed within a reasonable time frame. We ran this model
using two Intel Xeon Platinum 8160 processors with 24 processor cores each for a
total of 48 cores. Each processor core runs at a clock frequency of 2.1 GHz, with
a maximum boost clock of 3.7 GHz. The model uses roughly 70 GB of the available
DDR4 2666 MHz memory available in this system.</p>
<p>With this configuration using <span class="math notranslate nohighlight">\(10^{8}\)</span> photons and Python’s “-p 2” option
for logarithmic photon number stepping, the model takes roughly 10 ionization
cycles to converge in roughly 7.5 hours, or 360 total CPU hours. The spectral
cycles take a significantly longer time to complete. For six inclination angles and
<span class="math notranslate nohighlight">\(10^{8}\)</span> photons, a single spectral cycle takes in excess of three hours.
However, with <span class="math notranslate nohighlight">\(10^{6}\)</span> photons a spectral cycles takes roughly 100
seconds. We find that 5 - 10 spectral cycles with <span class="math notranslate nohighlight">\(10^{6}\)</span> photons
result in reasonable sacrifice between noise in the final spectrum and the
run time of the spectral cycles.</p>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Permalink to this heading"></a></h2>
<section id="synthetic-spectra">
<h3>Synthetic Spectra<a class="headerlink" href="#synthetic-spectra" title="Permalink to this heading"></a></h3>
<p>Below is a figure of three inclination angles of the emitted spectrum for this
model.</p>
<figure class="align-center" id="id2">
<img alt="../../../_images/tde_spectra.png" src="../../../_images/tde_spectra.png" />
<figcaption>
<p><span class="caption-text">Synthetic spectra of the TDE model for three inclination angles, as labelled
in the lower left. The 60 <span class="math notranslate nohighlight">\(^{\circ}\)</span> sight line is looking down, into, the
wind, whereas both noth the 10 <span class="math notranslate nohighlight">\(^{\circ}\)</span> and 75 <span class="math notranslate nohighlight">\(^{\circ}\)</span> sight lines
are not looking above and below the wind respectively. Important line
transitions have been labelled at the top of the plot.</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The model produces the strong resonance lines of N V, Si IV and C IV often seen
in UV spectra of TDEs and other objects with mildly ionized winds. We also
reproduce the BAL vs. BEL behaviour seen, as described in, i.e. <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2020MNRAS.494.4914P/abstract">Parkinson et al. (2020)</a>,.
For inclinations which look into the wind, BALs are preferentially produced
and for inclinations looking above or below the wind, BELs are instead seen.</p>
<p>In the optical portion of the spectrum, the model produces broad recombination
emission features for the Balmer series of lines as well as for He II. These
features have extended red wings, clearest at low inclination angles. At intermediate
and high inclinations, the emission features are double peaked due to the high
rotational velocity of the wind near the base of the wind, where these features
are forming.</p>
</section>
<section id="physical-properties">
<h3>Physical Properties<a class="headerlink" href="#physical-properties" title="Permalink to this heading"></a></h3>
<p>In the figure below, the physical properties of the outflow are shown.</p>
<figure class="align-center" id="id3">
<img alt="../../../_images/tde_wind.png" src="../../../_images/tde_wind.png" />
<figcaption>
<p><span class="caption-text">Contour plots of various physical parameters for the wind model, plotted on
a log-log spatial scale. The top left panel shows which parts of the wind
four inclination inclinations intersect.</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>At the base of the wind, the velocity is dominated by rotation. The rotational
velocity decreases with radius, due to conserving angular momentum. Far out in
the wind, the velocity is dominated by the polodial velocity, as set by the
velocity law in the model. The electron temperature and density are both greatest
at the base of the wind. The density decreases with radius, resulting in line
formation processes which scale with electron density, such as collisional
excitation, decreasing with radius also.</p>
<p>The outer top edge of the wind is cool, reaching temperature as low as
<span class="math notranslate nohighlight">\(T_{e} \sim 10^{3}\)</span> K. Python does not implement any dust or molecular
physics, hence the treatment of this region of the wind is highly approximate.
However, since the line formation we are interested in does not occur in this
region, our neglect of this physics should not effect the emergency spectrum.</p>
<p>To measure the ionization state of the wind, we define the ionization parameter
<span class="math notranslate nohighlight">\(U_{\text{H}}\)</span>,</p>
<div class="math notranslate nohighlight">
\[U_{\text{H}} = \frac{4\pi}{n_{\text{H}}c} \int_{13.6 \frac{\text{eV}}{h}}^{\infty} \frac{J_{\nu}}{h\nu}~d\nu,\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu\)</span> denotes frequency, <span class="math notranslate nohighlight">\(n_{\text{H}}\)</span> is the number density
of Hydrogen, <span class="math notranslate nohighlight">\(h\)</span> is Planck’s constant and <span class="math notranslate nohighlight">\(J_{\nu}\)</span> is the monochromatic
mean intensity. The ionization parameter measures the ratio of the number density
of Hydrogen ionizing photons to the local matter density. For values of <span class="math notranslate nohighlight">\(U_{\text{H}} &gt; 1\)</span>,
Hydrogen is ionized making it a useful predictor of the global ionization state.
The ionization parameter is fairly constant throughout the wind with <span class="math notranslate nohighlight">\(U_{\text{H}} \sim 10^{4}\)</span>,
indicating that the Hydrogen is ionized in much of the wind. At the very top of
the wind, the wind is highly ionized with <span class="math notranslate nohighlight">\(U_{\text{H}} \sim 10^{8}\)</span>. There is,
however, a portion of the wind where <span class="math notranslate nohighlight">\(U_{\text{H}} &lt; 1\)</span>. This part of the wind
is at the base of the wind and large disc radii, <span class="math notranslate nohighlight">\(\rho \sim 10^{15}\)</span> cm,
where Hydrogen is neutral. The density of neutral Hydrogen is, naturally, greatest
here with <span class="math notranslate nohighlight">\(n_{\text{H I}} \sim 10^{7} ~ \text{cm}^{-3}\)</span> and is where the
majority of H <span class="math notranslate nohighlight">\(\alpha\)</span> photons are emitted.</p>
</section>
</section>
<section id="files">
<h2>Files<a class="headerlink" href="#files" title="Permalink to this heading"></a></h2>
<p>Attached below is the parameter file for the model and three spectrum files.</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../../../_downloads/be652952d1ffdce2b8f943ddc117377f/tde_fiducial.pf"><code class="xref download docutils literal notranslate"><span class="pre">tde_fiducial.pf</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../../_downloads/6d846282115dfccb25c0e9e0b48dc27a/tde_fiducial.spec"><code class="xref download docutils literal notranslate"><span class="pre">tde_fiducial.spec</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../../_downloads/6a04ccebdcdba1fd9a91fa786efaae5e/tde_fiducial.log_spec"><code class="xref download docutils literal notranslate"><span class="pre">tde_fiducial.log_spec</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../../../_downloads/bd0fff5dd6bc63cc4d6044674fe29e18/tde_fiducial.spec_tot"><code class="xref download docutils literal notranslate"><span class="pre">tde_fiducial.spec_tot</span></code></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../quasar/quasar.html" class="btn btn-neutral float-left" title="Demo: Quasar, M20" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../benchmarking/cmfgen.html" class="btn btn-neutral float-right" title="Benchmark: 1D Stellar Wind, CMFGEN" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2024, Knox Long, Christian Knigge, Stuart Sim, Nick Higginbottom, James Matthews, Sam Mangham, Edward Parkinson, Mandy Hewitt, Nicolas Scepi, Austen Wallis, Amin Mosallanezhad.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>